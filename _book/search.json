[
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "MATH337: Changepoint Detection",
    "section": "",
    "text": "Preface\nThese are the notes for MATH337 Changepoint Detection. They were written by Gaetano Romano.\nThe module will introduce you to changepoint detection, detailing some algorithms, developing the basics theoretical foundations, and practicing few real-world scenarios.\nAcross five weeks we will cover the following topics:\n\nAn introduction to changepoint detection and the CUSUM statistics\nControlling the CUSUM and some additional models\nDealing with multiple changes\nPenalty selection\nBreaking the real-world assumptions.\n\nWe will be using R as the programming language for this module. If you’re unfamiliar with it, make sure you cover the first three weeks of MATH245.\nEvery week, you are expected to follow two lectures, one lab, and one computer aided workshop. Over the lecture, we will cover the basics concepts of changepoint detection. During the labs, you will be dealing with computations and details at your own pace, and, finally, during the workshops, you’ll give a go at programming the various algorithms and running real-world examples.",
    "crumbs": [
      "Preface"
    ]
  },
  {
    "objectID": "intro.html",
    "href": "intro.html",
    "title": "1  Introduction",
    "section": "",
    "text": "This is a book created from markdown and executable code.\nSee Knuth (1984) for additional discussion of literate programming.\n\n1 + 1\n\n[1] 2\n\n\n\n\n\n\nKnuth, Donald E. 1984. “Literate Programming.” Comput. J. 27 (2): 97–111. https://doi.org/10.1093/comjnl/27.2.97.",
    "crumbs": [
      "<span class='chapter-number'>1</span>  <span class='chapter-title'>Introduction</span>"
    ]
  },
  {
    "objectID": "summary.html",
    "href": "summary.html",
    "title": "2  Summary",
    "section": "",
    "text": "In summary, this book has no content whatsoever.\n\n1 + 1\n\n[1] 2",
    "crumbs": [
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>Summary</span>"
    ]
  },
  {
    "objectID": "references.html",
    "href": "references.html",
    "title": "References",
    "section": "",
    "text": "Knuth, Donald E. 1984. “Literate Programming.” Comput.\nJ. 27 (2): 97–111. https://doi.org/10.1093/comjnl/27.2.97.",
    "crumbs": [
      "References"
    ]
  },
  {
    "objectID": "1_intro_cusum.html",
    "href": "1_intro_cusum.html",
    "title": "1  An Introduction to Changepoint Detection",
    "section": "",
    "text": "1.1 Piecewise Stationary Time Series\nIn this module, we will be dealing with time series. A time series is a sequence of observations recorded over time (or space), where the order of the data points is crucial.",
    "crumbs": [
      "<span class='chapter-number'>1</span>  <span class='chapter-title'>An Introduction to Changepoint Detection</span>"
    ]
  },
  {
    "objectID": "2_control.html",
    "href": "2_control.html",
    "title": "2  Controlling the CUSUM and Other Models",
    "section": "",
    "text": "In summary, this book has no content whatsoever.\n\n1 + 1\n\n[1] 2",
    "crumbs": [
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>Controlling the CUSUM and Other Models</span>"
    ]
  },
  {
    "objectID": "1_intro_cusum.html#piecewise-constant-time-series",
    "href": "1_intro_cusum.html#piecewise-constant-time-series",
    "title": "1  An Introduction to Changepoint Detection",
    "section": "",
    "text": "1.1.1 What is a time series?\nIn previous modules, such as Likelihood Inference, we typically dealt with data that was not ordered in a particular way. For example, we might have worked with a sample of independent Gaussian observations, where each observation is drawn randomly from the same distribution. This sample might look like the following:\n\\[\n  y_i \\sim \\mathcal{N}(0,1), \\ i = 1, \\dots, 100\n\\]\nHere, \\(y_i\\) represents the \\(i\\)-th observation, and the assumption is that all observations are independent and identically distributed (i.i.d.) with a mean of 0 and variance of 1.\n\n\n\n\n\n\n\n\n\nIn this case, the observations do not have any particular order, and our primary interest may be in estimating parameters such as the mean, variance, or mode of the distribution. This is typical for traditional inference, where the order of observations is not of concern.\nHowever, a time series involves a specific order to the data—usually indexed by time, although it could also be by space or another sequential dimension. For example, we could assume that the Gaussian sample above is a sequential process, ordered by the time we drew an observation. Each observation corresponds to a specific time point \\(t\\). If the time points are indexed from 1 to 100, we would write the time series as:\n\\[\n  y_{1:100} = (y_1, y_2, \\dots, y_{100})\n\\]\nwhere \\(y_t\\) represents the observation at time \\(t\\), with, in case of our example, \\(t = 1, 2, \\dots, 100\\).",
    "crumbs": [
      "<span class='chapter-number'>1</span>  <span class='chapter-title'>An Introduction to Changepoint Detection</span>"
    ]
  },
  {
    "objectID": "1_intro_cusum.html#piecewise-stationary-time-series",
    "href": "1_intro_cusum.html#piecewise-stationary-time-series",
    "title": "1  An Introduction to Changepoint Detection",
    "section": "",
    "text": "1.1.1 What is a time series?\nIn previous modules, such as Likelihood Inference, we typically dealt with data that was not ordered in a particular way. For example, we might have worked with a sample of independent Gaussian observations, where each observation is drawn randomly from the same distribution. This sample might look like the following:\n\\[\n  y_i \\sim \\mathcal{N}(0,1), \\ i = 1, \\dots, 100\n\\]\nHere, \\(y_i\\) represents the \\(i\\)-th observation, and the assumption is that all observations are independent and identically distributed (i.i.d.) with a mean of 0 and variance of 1.\n\n\n\n\n\n\n\n\n\nIn this case, the observations do not have any particular order, and our primary interest may be in estimating parameters such as the mean, variance, or mode of the distribution. This is typical for traditional inference, where the order of observations is not of concern.\nHowever, a time series involves a specific order to the data—usually indexed by time, although it could also be by space or another sequential dimension. For example, we could assume that the Gaussian sample above is a sequential process, ordered by the time we drew an observation. Each observation corresponds to a specific time point \\(t\\):\n\n\n\n\n\n\n\n\n\nFormal Notation. In time series analysis, we typically denote a time series by using an index \\(t\\) to represent time or order. The time series vector is written as:\n\\[\n  y_{1:n} = (y_1, y_2, \\dots, y_n)\n\\]\nHere, \\(n\\) is the total length of the sequence, and \\(y_t\\) represents the observed value at time \\(t\\), for \\(t = 1, 2, \\dots, n\\). In our previous example, for instance, \\(n = 100\\).\nOften, we are also interested in subsets of a time series (inclusive), especially when investigating specific “windows” or “chunks” of the data. We will denote as a subset of the time series, from time \\(l\\) to time \\(u\\), the following:\n\\[\n  y_{l:u} = (y_l, y_{l+1}, \\dots, y_u)\n\\]\nUnderstanding and working with subsets of time series data is important for many applications, such as when detecting changes in the behavior or properties of the time series over specific intervals.\n\n\n1.1.2 Stationary, non-stationary, and piecewise stationary time series\nTime series can be classified into different categories based on their statistical properties over time. The three main types are stationary, non-stationary, and piecewise stationary time series. For example:\n\n\n\n\n\n\n\n\n\n\nStationary Time Series: A time series is said to be stationary if its statistical properties—such as the mean, variance, and autocovariance—are constant over time. This implies that the behavior of the series doesn’t change as time progresses.\n\nMathematically, for a stationary time series \\(y_t\\), the expected value and variance are constant over time: \\[\n    \\mathbb{E}(y_t) = \\mu \\quad \\text{and} \\quad \\text{Var}(y_t) = \\sigma^2 \\quad \\forall \\in \\{1, ..., n\\}\n\\] In this example, the stationary time series was generated by sampling random normal variables \\(y_t = \\epsilon_t, \\ \\epsilon_t \\sim \\mathcal{N}(0, 1)\\). We can see, very simply how, in this case: \\[\n    \\mathbb{E}(y_t) = \\mathbb{E}(\\epsilon_t) = 0, \\forall t \\in \\{1, ..., 100\\}\n\\]\n\nNon-Stationary Time Series: A time series is non-stationary if its statistical properties change over time. Often, non-stationary series exhibit trends or varying variances. For example, a series with a trend (increasing or decreasing) is non-stationary because the mean is not constant.\n\nA common form of non-stationarity is a linear trend, where the series grows over time. In our example, the non-stationary series is generated as: \\[\n    y_t = \\epsilon_t + 0.1 \\cdot t , \\ \\epsilon_t \\sim \\mathcal{N}(0, 1)\n\\] This creates a time series with a linear upward trend. In fact, similarly to what done before: \\[\n    \\mathbb{E}(y_t) = \\mathbb{E}(\\epsilon_t) + \\mathbb{E}(0.1 \\cdot t) = 0.1 \\cdot t.\n\\] Therefore: \\[\n  \\forall t_1, t_2 \\in \\{1, ..., 100\\}, t_1 \\neq t_2 \\rightarrow \\mathbb{E}(y_{t_1}) \\neq \\mathbb{E}(y_{t_2})\n\\]\n\nPiecewise Stationary Time Series: A piecewise stationary time series is stationary within certain segments but has changes in its statistical properties at certain points, known as changepoints. After each changepoint, the series may have a different mean, variance, or both.\n\nIn our example, the time series was stationary for the first half of the observations, but after \\(t = 50\\), a sudden shift occurs. Mathematically: \\[\ny_t = \\begin{cases}\n    \\epsilon_t & \\text{for } t \\leq 50 \\\\\n    \\epsilon_t + 5 & \\text{for } t &gt; 50\n    \\end{cases}, \\quad \\epsilon_t \\sim \\mathcal{N}(0, 1)\n\\] This abrupt change at \\(t = 50\\) introduces a piecewise structure to the data.",
    "crumbs": [
      "<span class='chapter-number'>1</span>  <span class='chapter-title'>An Introduction to Changepoint Detection</span>"
    ]
  },
  {
    "objectID": "1_intro_cusum.html#introduction-to-changepoints",
    "href": "1_intro_cusum.html#introduction-to-changepoints",
    "title": "1  An Introduction to Changepoint Detection",
    "section": "1.2 Introduction to changepoints",
    "text": "1.2 Introduction to changepoints\nChangepoints are sudden, and often unexpected, shifts in the behavior of a process. They are also known as breakpoints, structural breaks, or regime switches. The detection of changepoints is crucial in understanding and responding to changes in various types of time series data.\nThe primary objectives in detecting changepoints include:\n\nHas a change occurred?: Identifying if there is a shift in the data.\nIf yes, where is the change?: Locating the precise point where the change happened.\nWhat is the difference between the pre and post-change data? This may reveal the type of change, and it could indicate differences in parameter values before and after the change.\nHow certain are we of the changepoint location?: Assessing the confidence in the detected changepoint.\nHow many changes have occurred?: Identifying multiple changepoints and analyzing each one for similar characteristics.\n\nChangepoints can be found in a wide range of time series, not limited to physical, biological, industrial, or financial processes. For instance, to give few examples:\n\nECG: Detecting changes or abnormalities in electrocardiogram (ECG) data can help in diagnosing heart conditions.\n\n\n\nElectrocardiograms (heart monitoring), Fotoohinasab et al, Asilomar conference 2020.\n\n\nCancer Diagnosis: Identifying breakpoints in DNA copy number data is important for diagnosing some types of cancer, such as neuroblastoma.\n\n\n\nDNA copy number data, breakpoints associated with aggressive cancer, Hocking et al, Bioinformatics 2014.\n\n\nEngineering Monitoring: Detecting changes in CPU monitoring data in servers can help in identifying potential issues or failures.\n\n\n\nTemperature data from a CPU of an AWS server. Source Romano et al., (2023)\n\n\n\n\n1.2.1 Types of Changes in Time Series\nAs you might have noticed from the examples above, there’s not a strict way on which a time-series might change. Depending on the model, we could seek for different types of changes in the structure of a time series. Some of the most common types of changes include shifts in mean, variance, and trends in regression. For example, the CPU example above exihibited, in addition to some extreme observations, both changes in mean and variance.\n\nA change in mean occurs when the average level of an otherwise stationary time series shifts from one point to another. This type of change is often encountered in real-world data when there is a sudden shift in the process generating the data, such as a change in policy, market conditions, or external factors affecting the system.\n\n\n\n\n\n\n\n\n\n\nIn the plot above, the red lines indicate the true mean values of the different segments.\n\nA change in variance refers to a shift in the variability of the time series data, even when the mean remains constant. This type of change is important in scenarios where the stability of a process fluctuates over time. For example, in financial markets, periods of high volatility (high variance) may be followed by periods of relative calm (low variance).\n\n\n\n\n\n\n\n\n\n\n\n1.2.1.1 3. Change in Regression (Trend)\nA change in regression or trend occurs when the underlying relationship between time and the values of the time series changes. This could reflect a shift in the growth or decline rate of a process. For example, a company’s revenue might grow steadily over a period, then plateau, and later exhibit a quadratic or nonlinear growth trend.\n\n\n\n\n\n\n\n\n\n\n\n\n1.2.2 The biggest data challenge in changepoint detection\nOne of the most widely debated and difficult data challenges in changepoint detection may not be in the field of finance, genetics, or climate science—but rather in television history. Specifically, the question that has plagued critics and fans alike for years is: At which episode did “The Simpsons” start to decline?\nIt’s almost common knowledge that “The Simpsons,” the longest-running and most beloved animated sitcom, experienced a significant drop in quality over time. Critics, die-hard fans, and casual viewers alike have pointed to a shift in humor, writing, and overall creativity. But pinpointing exactly when this drop occurred is the real challenge. Fortunately, there’s a branch of statistics that was practically built to answer questions like these!\nI have downloaded a dataset (Bown 2023) containing ratings for every episode of “The Simpsons” up to season 34. We will analyze this data to determine if and when a significant shift occurred in the ratings, which might reflect the decline in quality that so many have observed.\n\n\n\n\n\n\n\n\n\nIn this plot, each episode of “The Simpsons” is represented by its TMBD rating, and episodes are colored by season. By visually inspecting the graph, we may already start to see some potential points where the ratings decline. However, the goal of our changepoint analysis is to move beyond visual inspection and rigorously detect the exact moment where a significant shift in the data occurs.\nJokes apart, this is a challenging time series! First of all, there’s not a clear single change, but rather an increase, followed by a decline. After which, the sequence seems rather stationary. For this reason, throughout the module, we will use this data as a running example to develop our understanding of various methods, hopefully trying to obtain a definitive answer towards the final chapters. But let’s procede in order…",
    "crumbs": [
      "<span class='chapter-number'>1</span>  <span class='chapter-title'>An Introduction to Changepoint Detection</span>"
    ]
  },
  {
    "objectID": "1_intro_cusum.html#detecting-one-change-in-mean-the-cusum-statistic",
    "href": "1_intro_cusum.html#detecting-one-change-in-mean-the-cusum-statistic",
    "title": "1  An Introduction to Changepoint Detection",
    "section": "1.3 Detecting one change-in-mean: the CUSUM Statistic",
    "text": "1.3 Detecting one change-in-mean: the CUSUM Statistic\n\n\n\n\nBown, Jonathan. 2023. “Simpsons Episodes & Ratings (1989-Present).” https://www.kaggle.com/datasets/jonbown/simpsons-episodes-2016?resource=download.",
    "crumbs": [
      "<span class='chapter-number'>1</span>  <span class='chapter-title'>An Introduction to Changepoint Detection</span>"
    ]
  }
]